<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Creating Your Own App | Speckle Docs</title>
    <meta name="generator" content="VuePress 1.8.2">
    <script src="/scripts/scroll-to-hash.js"></script>
    <meta name="description" content="Documentation on everything Speckle">
    <meta name="theme-color" content="#0480FB">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.df7ac8e6.css" as="style"><link rel="preload" href="/assets/js/app.99a85e76.js" as="script"><link rel="preload" href="/assets/js/4.4326cdb2.js" as="script"><link rel="preload" href="/assets/js/8.34516b02.js" as="script"><link rel="prefetch" href="/assets/js/10.3e7ac9b8.js"><link rel="prefetch" href="/assets/js/11.a4694f2f.js"><link rel="prefetch" href="/assets/js/12.c114fb3d.js"><link rel="prefetch" href="/assets/js/13.7cc92742.js"><link rel="prefetch" href="/assets/js/14.f4163000.js"><link rel="prefetch" href="/assets/js/15.2efb9a44.js"><link rel="prefetch" href="/assets/js/16.21572a9c.js"><link rel="prefetch" href="/assets/js/17.0ca52ce1.js"><link rel="prefetch" href="/assets/js/18.156d8e4d.js"><link rel="prefetch" href="/assets/js/19.ae2b9c8c.js"><link rel="prefetch" href="/assets/js/20.ee5275bb.js"><link rel="prefetch" href="/assets/js/21.60e9f828.js"><link rel="prefetch" href="/assets/js/22.9780a091.js"><link rel="prefetch" href="/assets/js/23.3af4e7e3.js"><link rel="prefetch" href="/assets/js/24.0b6908e4.js"><link rel="prefetch" href="/assets/js/25.15884d28.js"><link rel="prefetch" href="/assets/js/26.4182a715.js"><link rel="prefetch" href="/assets/js/27.f73e931d.js"><link rel="prefetch" href="/assets/js/28.526514f8.js"><link rel="prefetch" href="/assets/js/29.254ef804.js"><link rel="prefetch" href="/assets/js/3.2c817222.js"><link rel="prefetch" href="/assets/js/30.7b9c4b8b.js"><link rel="prefetch" href="/assets/js/31.0ae384c7.js"><link rel="prefetch" href="/assets/js/32.ff7dc8a3.js"><link rel="prefetch" href="/assets/js/33.22ee2056.js"><link rel="prefetch" href="/assets/js/34.32233c9e.js"><link rel="prefetch" href="/assets/js/35.87aa89ee.js"><link rel="prefetch" href="/assets/js/36.a1e3d380.js"><link rel="prefetch" href="/assets/js/37.121a0a1c.js"><link rel="prefetch" href="/assets/js/38.6270b359.js"><link rel="prefetch" href="/assets/js/39.72767cb8.js"><link rel="prefetch" href="/assets/js/40.d2261fc4.js"><link rel="prefetch" href="/assets/js/41.3b2b05a8.js"><link rel="prefetch" href="/assets/js/42.c88af68f.js"><link rel="prefetch" href="/assets/js/43.47abbed9.js"><link rel="prefetch" href="/assets/js/44.125e48f0.js"><link rel="prefetch" href="/assets/js/45.1c8bf8c8.js"><link rel="prefetch" href="/assets/js/46.e76c532e.js"><link rel="prefetch" href="/assets/js/47.19a7f421.js"><link rel="prefetch" href="/assets/js/48.33e9e938.js"><link rel="prefetch" href="/assets/js/49.c89f1432.js"><link rel="prefetch" href="/assets/js/5.6a902ace.js"><link rel="prefetch" href="/assets/js/50.35f05f89.js"><link rel="prefetch" href="/assets/js/51.f1a6f631.js"><link rel="prefetch" href="/assets/js/52.e7cf1987.js"><link rel="prefetch" href="/assets/js/53.5137e2c4.js"><link rel="prefetch" href="/assets/js/54.f9641ffa.js"><link rel="prefetch" href="/assets/js/55.3e64c05b.js"><link rel="prefetch" href="/assets/js/56.3a1b3c96.js"><link rel="prefetch" href="/assets/js/57.0255fe1f.js"><link rel="prefetch" href="/assets/js/58.78203d8e.js"><link rel="prefetch" href="/assets/js/59.e0afe630.js"><link rel="prefetch" href="/assets/js/6.42ae08b8.js"><link rel="prefetch" href="/assets/js/60.d648178f.js"><link rel="prefetch" href="/assets/js/61.ba653bbd.js"><link rel="prefetch" href="/assets/js/62.25d813a4.js"><link rel="prefetch" href="/assets/js/63.f9688f43.js"><link rel="prefetch" href="/assets/js/64.d6f115ed.js"><link rel="prefetch" href="/assets/js/65.36f31357.js"><link rel="prefetch" href="/assets/js/7.a2af4118.js"><link rel="prefetch" href="/assets/js/9.d41b359b.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.4b331d06.js">
    <link rel="stylesheet" href="/assets/css/0.styles.df7ac8e6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/logo-docs.png" alt="Speckle Docs" class="logo"> <span class="site-name can-hide">Speckle Docs</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  User Guide
</a></div><div class="nav-item"><a href="/dev/" class="nav-link router-link-active">
  Developer Docs
</a></div><div class="nav-item"><a href="https://speckle.systems" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Speckle Website
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://speckle.systems/getstarted/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Get Started
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/specklesystems/speckle-docs/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  User Guide
</a></div><div class="nav-item"><a href="/dev/" class="nav-link router-link-active">
  Developer Docs
</a></div><div class="nav-item"><a href="https://speckle.systems" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Speckle Website
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://speckle.systems/getstarted/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Get Started
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/specklesystems/speckle-docs/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Developer Docs üë©‚Äçüíª</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/dev/architecture.html" class="sidebar-link">Architecture</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Core Concepts</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/base.html" class="sidebar-link">The Base Object</a></li><li><a href="/dev/decomposition.html" class="sidebar-link">Decomposition API</a></li><li><a href="/dev/kits.html" class="sidebar-link">Kits</a></li><li><a href="/dev/transports.html" class="sidebar-link">Transports</a></li><li><a href="/dev/apps-auth.html" class="sidebar-link">Apps &amp; Auth</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Advanced Concepts</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>.NET SDK</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/dotnet.html" class="sidebar-link">Introduction</a></li><li><a href="/dev/objects.html" class="sidebar-link">Objects Kit</a></li><li><a href="/dev/connectors-dev.html" class="sidebar-link">Writing Your Own connector</a></li><li><a href="/dev/kits-dev.html" class="sidebar-link">Writing Your Own Kit</a></li><li><a href="/dev/transports-dev.html" class="sidebar-link">Writing Your Own Transport</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Python SDK</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/python.html" class="sidebar-link">Introduction</a></li><li><a href="/dev/py-examples.html" class="sidebar-link">Examples</a></li><li><a href="/dev/py-sample.html" class="sidebar-link">Tutorial: Simple Dashboard</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Javascript SDK</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/js.html" class="sidebar-link">Introduction</a></li><li><a href="/dev/viewer.html" class="sidebar-link">Using our embeddable 3D viewer</a></li><li><a href="/dev/js-app-script.html" class="sidebar-link">Using Google Apps Scripts</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Server API &amp; Apps</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/server-api.html" class="sidebar-link">Introduction</a></li><li><a href="/dev/server-graphql-api.html" class="sidebar-link">GraphQL API</a></li><li><a href="/dev/server-rest-api.html" class="sidebar-link">REST API</a></li><li><a href="/dev/server-webhooks.html" class="sidebar-link">Webhooks</a></li><li><a href="/dev/server-setup.html" class="sidebar-link">Deploying a Server - DigitalOcean Marketplace App</a></li><li><a href="/dev/server-manualsetup.html" class="sidebar-link">Deploying a Server - manual setup</a></li><li><a href="/dev/tokens.html" class="sidebar-link">Personal Access Tokens</a></li><li><a href="/dev/apps.html" aria-current="page" class="active sidebar-link">Creating Your Own App</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dev/apps.html#requirements" class="sidebar-link">Requirements</a></li><li class="sidebar-sub-header"><a href="/dev/apps.html#setting-up-the-vue-app" class="sidebar-link">Setting up the Vue app</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dev/apps.html#install-other-dependencies" class="sidebar-link">Install other dependencies</a></li><li class="sidebar-sub-header"><a href="/dev/apps.html#run-your-app-for-the-first-time" class="sidebar-link">Run your app for the first time</a></li></ul></li><li class="sidebar-sub-header"><a href="/dev/apps.html#authenticating-with-the-server" class="sidebar-link">Authenticating with the Server</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dev/apps.html#creating-the-speckle-files" class="sidebar-link">Creating the Speckle files</a></li><li class="sidebar-sub-header"><a href="/dev/apps.html#registering-an-application-on-the-speckle-server" class="sidebar-link">Registering an Application on the Speckle Server</a></li><li class="sidebar-sub-header"><a href="/dev/apps.html#login-in-with-speckle" class="sidebar-link">Login in with Speckle</a></li></ul></li><li class="sidebar-sub-header"><a href="/dev/apps.html#fetching-user-data" class="sidebar-link">Fetching user data</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dev/apps.html#user-data-query" class="sidebar-link">User data query</a></li><li class="sidebar-sub-header"><a href="/dev/apps.html#modify-app-store" class="sidebar-link">Modify app store</a></li><li class="sidebar-sub-header"><a href="/dev/apps.html#update-app-vue" class="sidebar-link">Update App.vue</a></li><li class="sidebar-sub-header"><a href="/dev/apps.html#update-router-beforeeach" class="sidebar-link">Update router.beforeEach</a></li></ul></li><li class="sidebar-sub-header"><a href="/dev/apps.html#searching-for-streams" class="sidebar-link">Searching for streams</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dev/apps.html#search-query" class="sidebar-link">Search query</a></li><li class="sidebar-sub-header"><a href="/dev/apps.html#modify-app-store-2" class="sidebar-link">Modify app store</a></li><li class="sidebar-sub-header"><a href="/dev/apps.html#create-child-components" class="sidebar-link">Create child components</a></li><li class="sidebar-sub-header"><a href="/dev/apps.html#update-home-vue" class="sidebar-link">Update Home.vue</a></li><li class="sidebar-sub-header"><a href="/dev/apps.html#update-app-vue-2" class="sidebar-link">Update App.vue</a></li><li class="sidebar-sub-header"><a href="/dev/apps.html#preview-results" class="sidebar-link">Preview results</a></li></ul></li><li class="sidebar-sub-header"><a href="/dev/apps.html#displaying-stream-commits" class="sidebar-link">Displaying stream commits</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dev/apps.html#create-fetch-query" class="sidebar-link">Create fetch query</a></li></ul></li><li class="sidebar-sub-header"><a href="/dev/apps.html#update-store-index-js" class="sidebar-link">Update store/index.js</a></li><li class="sidebar-sub-header"><a href="/dev/apps.html#update-home-vue-2" class="sidebar-link">Update Home.vue</a></li><li class="sidebar-sub-header"><a href="/dev/apps.html#preview-result" class="sidebar-link">Preview result</a></li><li class="sidebar-sub-header"><a href="/dev/apps.html#adding-data-persistence" class="sidebar-link">Adding data persistence</a></li><li class="sidebar-sub-header"><a href="/dev/apps.html#publish-to-netlify" class="sidebar-link">Publish to Netlify</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dev/apps.html#create-your-site" class="sidebar-link">Create your site</a></li></ul></li><li class="sidebar-sub-header"><a href="/dev/apps.html#wrapping-it-up" class="sidebar-link">Wrapping it up</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="creating-your-own-app"><a href="#creating-your-own-app" class="header-anchor">#</a> Creating Your Own App</h1> <p><img src="/assets/img/app-guide-main-img.558cd4a9.jpg" alt=""></p> <p>Welcome to <strong>Part 1</strong> this multi-part guide on how to <code>Create your own App</code> using Speckle. It's geared towards an audience that is familiar with Javascript and web development, or at least not scared by it!</p> <p>In this first part, we'll be creating a very simple web app capable of:</p> <ul><li>Authenticating a user through a Speckle server OAuth.</li> <li>Search for stream's available to the user.</li> <li>Display commit data associated with a given stream.</li> <li>Filter the data to be displayed.</li> <li>Cache results in <code>localStorage</code> to <em>remember</em> the app state across page reloads.</li></ul> <p>Let's get started! üöÄ</p> <div class="custom-block tip"><p class="custom-block-title">Following along</p> <p>If too busy to follow all the steps, you can find the entire code for this guide <a href="https://github.com/specklesystems/speckle-demo-app" target="_blank" rel="noopener noreferrer">in this repository<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <h2 id="requirements"><a href="#requirements" class="header-anchor">#</a> Requirements</h2> <p>This guide should work in any platform (Mac/Linux/Windows). We'll be using <em>VSCode</em> as our IDE but you can use any other (even Notepad if your brave enough!).</p> <p>You'll also need to have Node installed, as well as <code>vue-cli</code> and have some basic understanding of how Vue works.</p> <div class="custom-block tip"><p class="custom-block-title">Installing the prerequisites</p> <p><strong>Node:</strong> Probably the easiest way to manage your node installation is through <code>nvm</code>. On Windows, you can <a href="https://github.com/coreybutler/nvm-windows#install-nvm-windows" target="_blank" rel="noopener noreferrer">use this guide<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. If on OSX, you can use the <a href="https://github.com/nvm-sh/nvm#installing-and-updating" target="_blank" rel="noopener noreferrer">original nvm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p><strong>Vue CLI</strong>: Once you have node installed, it's just a matter of running <code>npm install -g @vue/cli</code>.</p></div> <div class="custom-block warning"><p class="custom-block-title">Getting familiar with Vue</p> <p>If you haven't used Vue before, don't worry. It's quite easy to get started with it - here's <a href="https://vuejs.org/v2/guide/" target="_blank" rel="noopener noreferrer">some docs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> you could run through beforehand.</p> <p>We'll also be using some of Vue's most popular plugins: <code>vuex</code> and <code>vue-router</code>. If you're unfamiliar with them, they have great quick-start guides on their site!</p> <ul><li><a href="https://vuex.vuejs.org/guide/" target="_blank" rel="noopener noreferrer"><code>vuex</code>: Getting started<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://router.vuejs.org/guide/" target="_blank" rel="noopener noreferrer"><code>vue-router</code>: Getting started<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <h2 id="setting-up-the-vue-app"><a href="#setting-up-the-vue-app" class="header-anchor">#</a> Setting up the Vue app</h2> <p>This is the simplest step. Open a new terminal, set the current directory to wherever you want the project to be located and run the following command:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>vue create speckle-demo-app
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This will ask you some questions, such as the version of vue to use, what plugins to install, etc. <strong>It is important that you answer the questions correctly</strong>, otherwise, your project may be missing some key features.</p> <details class="custom-block details"><summary>Vue setup - Step by step</summary> <ol><li>When prompted for a preset, select <strong>Manually select features</strong> <img src="/assets/img/app-guide-vue-setup-step1.dcfa5f44.png" alt=""></li> <li>Next, specify the features needed for this project:
<ul><li>Choose vue version</li> <li>Babel</li> <li>PWA</li> <li>Router</li> <li>Vuex</li> <li>CSS Pre-processors</li> <li>Linter
<img src="/assets/img/app-guide-vue-setup-step2.05778446.png" alt=""></li></ul></li> <li>Choose version <strong>2.x</strong> of Vue.js
<img src="/assets/img/app-guide-vue-setup-step3.4097c34f.png" alt=""></li> <li>Choose <strong>Yes</strong> when prompted to use <strong>history mode for router</strong> <img src="/assets/img/app-guide-vue-setup-step4.ec673eac.png" alt=""></li> <li>For the css-preprocessor to use, select <strong>Sass/SCSS (with dart-sass)</strong> <img src="/assets/img/app-guide-vue-setup-step5.c8848709.png" alt=""></li> <li>When prompted for a Linter, choose the option <strong>ESLint with error prevention only</strong> <img src="/assets/img/app-guide-vue-setup-step6.fc39a92e.png" alt=""></li> <li>When prompted for aditional lint features, select <strong>Lint on save</strong> <img src="/assets/img/app-guide-vue-setup-step7.d4eddbd5.png" alt=""></li> <li>Choose to place config files <strong>In dedicated config files</strong> <img src="/assets/img/app-guide-vue-setup-step8.cfe4baaf.png" alt=""></li> <li>At last, you can save this selection as a preset, but for this time just select <strong>No</strong> <img src="/assets/img/app-guide-vue-setup-step9.b8f89232.png" alt=""></li> <li>Wait for the process to finish
<img src="/assets/img/app-guide-vue-setup-step10.4d92a129.png" alt=""></li></ol></details> <div class="custom-block tip"><p class="custom-block-title">TL;DR</p> <p>If you are already familiar with this process, just select the same answers as the screenshot bellow:</p> <p><img src="/assets/img/app-guide-vue-setup.55edbdef.png" alt=""></p></div> <p>Once done, you'd have your Vue project ready. To open the project in <strong>VSCode</strong> we just need to run:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>code speckle-demo-app
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>This step assumes you already installed VSCode in your path. If you haven't, there's a command for it in VSCode.</p> <p><img src="/assets/img/app-guide-vscode-shell-install.df19f814.png" alt=""></p></div> <h3 id="install-other-dependencies"><a href="#install-other-dependencies" class="header-anchor">#</a> Install other dependencies</h3> <p>For our UI, we'll also be using <a href="TODO">Vuetify</a> to make our life easier, as it has many useful components. To add it, run:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>vue <span class="token function">add</span> vuetify
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>When asked for a preset, choose <strong>Default</strong>.</p> <p>We'll also need to add a couple of handy dependencies such as <code>vuex-persist</code> for state storage, <code>vue-timeago</code> to display user-friendly dates and <code>debounce</code>. For this, run the following command:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i vuex-persist vue-timeago debounce
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="run-your-app-for-the-first-time"><a href="#run-your-app-for-the-first-time" class="header-anchor">#</a> Run your app for the first time</h3> <p>If everything went well, running the following command should make the app available at <a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">http://localhost:8080<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> run serve
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>In chrome, things should be looking like this:</p> <p><img src="/assets/img/app-guide-setup-preview.a007a970.png" alt=""></p> <h2 id="authenticating-with-the-server"><a href="#authenticating-with-the-server" class="header-anchor">#</a> Authenticating with the Server</h2> <h3 id="creating-the-speckle-files"><a href="#creating-the-speckle-files" class="header-anchor">#</a> Creating the <code>Speckle</code> files</h3> <p>For convenience, we're going to isolate all the <code>speckle</code> related code into 2 files:</p> <ul><li><code>src/speckleQueries.js</code> will hold some utility functions to build our <code>GraphQL</code> queries.</li> <li><code>src/speckleUtils.js</code> will hold all call's to the Speckle server, as well as some constants. It will deal with login/logout functionality too.</li></ul> <h3 id="registering-an-application-on-the-speckle-server"><a href="#registering-an-application-on-the-speckle-server" class="header-anchor">#</a> Registering an Application on the Speckle Server</h3> <p>In order to be able to talk to our Speckle server, we first need to <code>Create an App</code> in that server with an existing account. To do that, visit the server's frontend <a href="https://speckle.xyz" target="_blank" rel="noopener noreferrer">https://speckle.xyz<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, log in with your account and visit the profile page.</p> <p>Scroll down until you see the <code>Applications</code> section, and press the <code>New App</code> button. A pop-up should appear, fill it in as follows:</p> <ul><li><strong>Name:</strong> SpeckleDemoApp</li> <li><strong>Scopes</strong>: <code>stream:read</code>, <code>profile:read</code>, <code>profile:email</code></li> <li><strong>Redirect url</strong>: <code>http://localhost:8080</code></li> <li><strong>Description</strong>: My first speckle app</li></ul> <p>Once accepted, you'll see the <code>App Id</code> and <code>App Secret</code>, as well as an indication to the url pattern we should use (<code>https://speckle.xyz/authn/verify/{appId}/{challenge}</code>).</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Note that the <code>redirect url</code> points to our local computer network. When deploying this app to a service like Netlify, we'll have to create a new one pointing to the correct Netlify url.</p></div> <h4 id="saving-app-credentials-as-env-variables"><a href="#saving-app-credentials-as-env-variables" class="header-anchor">#</a> Saving app credentials as ENV variables</h4> <p>The <code>App Id</code> and <code>App Secret</code> are used to identify your app, so you should never add them to your version control. Instead, we'll be using <code>ENV</code> variables to save that information, which also allows us to modify it in different scenarios (development/production).</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>For those of you who wonder, frontend applications that integrate with the Speckle Server are treated as OAuth <strong>public applications</strong>, because they cannot keep their id and secret safe.</p></div> <p>Vue will automatically read any <code>.env</code> files in the root of your project and load the variables accordingly, but will also replace all references with the actual value of the variable on compilation (which we <strong>do not want</strong>). We can tell <code>vue.js</code> to not do this by creating a file named <code>.env.local</code> instead. The contents should look like this üëáüèº (remember to replace your ID and Secret appropriately).</p> <div class="language-env line-numbers-mode"><pre class="language-text"><code>VUE_APP_SPECKLE_ID=YOUR_APP_ID # The Speckle Application Id
VUE_APP_SPECKLE_SECRET=YOUR_APP_SECRET # The Speckle Application Secret
VUE_APP_SERVER_URL=https://speckle.xyz
VUE_APP_SPECKLE_NAME=SpeckleDemo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="login-in-with-speckle"><a href="#login-in-with-speckle" class="header-anchor">#</a> Login in with Speckle</h3> <p>A simplified version of the auth flow with a Speckle Server can be summarised as follows:</p> <ol><li>User clicks the Login button</li> <li>User is redirected to the auth page in the Speckle server (using the provided url pattern when creating an application)</li> <li>User will log in and allow the app to access his data (hopefully?).</li> <li>User is redirected to our specified <code>Redirect URL</code>, with an attached <code>access_code</code>.</li> <li>Using that access code, we can exchange it for a pair of <code>token/refresh token</code>, which is what allows the app to &quot;talk&quot; to the server as that user. We'll save those in <code>localStorage</code>.</li></ol> <p>This may sound rather complicated, but it boils down to 2 different interactions (redirect your user and exchange the access code).</p> <h4 id="adding-auth-functions-to-speckleutils-js"><a href="#adding-auth-functions-to-speckleutils-js" class="header-anchor">#</a> Adding auth functions to <code>speckleUtils.js</code></h4> <p>In our <code>src/speckleUtils.js</code> file, paste in the following code. You'll find some constants that refer to our previously set <code>ENV</code> variables, as well as several functions.</p> <ul><li><code>goToSpeckleAuthPage</code>: Will generate a random challenge, save it in localStorage and direct the url to the auth page in the specified speckle server.</li> <li><code>exchangeAccessCode</code>: Will <code>fetch</code> from the server a new pair of <code>token/refresh token</code> and clear the <code>challenge</code>.</li> <li><code>speckleLogOut</code>: Will erase all necessary data from <code>localStorage</code>.</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Note that <code>goToSpeckleAuthPage</code> saves the challenge, and <code>exchangeAccessCode</code> uses that same challenge to exchange the tokens. If the challenge used doesn't match, the request will fail.</p></div> <details class="custom-block details"><summary>speckleUtils.js</summary> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">APP_NAME</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_SPECKLE_NAME</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">SERVER_URL</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_SERVER_URL</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">TOKEN</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">APP_NAME</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.AuthToken</span><span class="token template-punctuation string">`</span></span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">REFRESH_TOKEN</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">APP_NAME</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.RefreshToken</span><span class="token template-punctuation string">`</span></span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">CHALLENGE</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">APP_NAME</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.Challenge</span><span class="token template-punctuation string">`</span></span>

<span class="token comment">// Redirects to the Speckle server authentication page, using a randomly generated challenge. Challenge will be stored to compare with when exchanging the access code.</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">goToSpeckleAuthPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Generate random challenge</span>
  <span class="token keyword">var</span> challenge <span class="token operator">=</span>
    Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">+</span>
    Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>
  <span class="token comment">// Save challenge in localStorage</span>
  localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token constant">CHALLENGE</span><span class="token punctuation">,</span> challenge<span class="token punctuation">)</span>
  <span class="token comment">// Send user to auth page</span>
  window<span class="token punctuation">.</span>location <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">SERVER_URL</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/authn/verify/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_SPECKLE_ID</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>challenge<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>

<span class="token comment">// Log out the current user. This removes the token/refreshToken pair.</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">speckleLogOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Remove both token and refreshToken from localStorage</span>
  localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token constant">TOKEN</span><span class="token punctuation">)</span>
  localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token constant">REFRESH_TOKEN</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Exchanges the provided access code with a token/refreshToken pair, and saves them to local storage.</span>
<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">exchangeAccessCode</span><span class="token punctuation">(</span><span class="token parameter">accessCode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">SERVER_URL</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/auth/token/</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    method<span class="token operator">:</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span>
    headers<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      accessCode<span class="token operator">:</span> accessCode<span class="token punctuation">,</span>
      appId<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_SPECKLE_ID</span><span class="token punctuation">,</span>
      appSecret<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_SPECKLE_SECRET</span><span class="token punctuation">,</span>
      challenge<span class="token operator">:</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token constant">CHALLENGE</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// If retrieving the token was successful, remove challenge and set the new token and refresh token</span>
    localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token constant">CHALLENGE</span><span class="token punctuation">)</span>
    localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token constant">TOKEN</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>token<span class="token punctuation">)</span>
    localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token constant">REFRESH_TOKEN</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>refreshToken<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> data
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div></details> <h4 id="linking-to-vuex"><a href="#linking-to-vuex" class="header-anchor">#</a> Linking to <code>vuex</code></h4> <p>Since we're using <code>vuex</code> to manage the state of our application, we'll also add the redirect, exchange and logout logic as <code>actions</code>. We can then invoke them in any of our application components.</p> <p>Replace the contents of the file <code>src/store/index.js</code> with the following:</p> <details class="custom-block details"><summary>store/index.js</summary> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">&quot;vuex&quot;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span>
  exchangeAccessCode<span class="token punctuation">,</span>
  getUserData<span class="token punctuation">,</span>
  goToSpeckleAuthPage<span class="token punctuation">,</span>
  speckleLogOut
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/speckleUtils&quot;</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  getters<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">logout</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Wipe the state</span>

      <span class="token comment">// Wipe the tokens</span>
      <span class="token function">speckleLogOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">exchangeAccessCode</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> accessCode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Here, we could save the tokens to the store if necessary.</span>
      <span class="token keyword">return</span> <span class="token function">exchangeAccessCode</span><span class="token punctuation">(</span>accessCode<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">redirectToAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Use the speckleUtils redirect logic</span>
      <span class="token function">goToSpeckleAuthPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  modules<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div></details> <p>We can now use these actions in any component by calling <code>this.$store.dispatch(ACTION_NAME, ...params)</code>.</p> <h4 id="add-log-in-log-out-buttons"><a href="#add-log-in-log-out-buttons" class="header-anchor">#</a> Add <code>Log In/Log Out</code> buttons</h4> <p>In your <code>App.vue</code> file, replace it's contents with the following:</p> <details class="custom-block details"><summary>App.vue</summary> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-app</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-app-bar</span> <span class="token attr-name">app</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dark</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>d-flex align-center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-img</span>
          <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Speckle Logo<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>shrink mr-2<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">contain</span>
          <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>require(`@/assets/img.png`)<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">transition</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scale-transition<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>24<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>SPECKLE DEMO APP<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-spacer</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-spacer</span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-btn</span>
        <span class="token attr-name">outlined</span>
        <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>!isAuthenticated<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$store.dispatch(<span class="token punctuation">'</span>redirectToAuth<span class="token punctuation">'</span>)<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>Login with Speckle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-btn</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-btn</span> <span class="token attr-name">outlined</span> <span class="token attr-name">v-else</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$store.dispatch(<span class="token punctuation">'</span>logout<span class="token punctuation">'</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        Log out
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-btn</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-app-bar</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-main</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- &lt;router-view /&gt; --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-main</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-app</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;App&quot;</span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">isAuthenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div></details> <p>Notice there's an <code>isAuthenticated</code> computed property that defaults to <code>false</code> for now (we'll update it later). There's also a pair of <code>v-btn</code> buttons linked to this boolean value. When there is no user authenticated, we'll show the login button, and when there is a user authenticated, we'll show the Log Out button.</p> <p>Each is bound to the actions in the store we created earlier.</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-btn</span>
  <span class="token attr-name">outlined</span>
  <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>!isAuthenticated<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$store.dispatch(<span class="token punctuation">'</span>redirectToAuth<span class="token punctuation">'</span>)<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>Login with Speckle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-btn</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-btn</span> <span class="token attr-name">outlined</span> <span class="token attr-name">v-else</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$store.dispatch(<span class="token punctuation">'</span>logout<span class="token punctuation">'</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  Log out
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-btn</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>At this point in time, your App should display only a menu bar with the title and the Log In button.</p> <p><img src="/assets/img/app-guide-login-button.15a2f567.png" alt=""></p> <p>Now press the Log In button, follow the steps in the server and allow the app to access your data. This will take you back to <code>http://localhost:8080</code>. But notice the url will now contain a trailing <code>?access_code=YOUR_ACCESS_CODE</code>, we can now edit our <code>src/router/index.js</code> file to exchange the access code whenever it finds one.</p> <p><img src="/assets/img/app-guide-redirect-access-code.22258739.png" alt=""></p> <h4 id="exchange-the-access-code"><a href="#exchange-the-access-code" class="header-anchor">#</a> Exchange the <code>access_code</code></h4> <p>In order to exchange the access code automatically whenever it is provided in the url, we're going to use one of <code>vue-router</code>'s features. <code>vue-router</code> is the plugin that handles url routes in your app, it also parses query values and url parameters so you won't have to.</p> <p>We can implement a <code>beforeEach</code> handler, that will allow us to run some code right before each page is loaded in our app. At this point, we'll check if it contains an access code and if so, exchange it.</p> <p>Open your <code>src/router/index.js</code> file and add this code right above the <code>export default router</code> line.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>query<span class="token punctuation">.</span>access_code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// If the route contains an access code, exchange it</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">await</span> store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">&quot;exchangeAccessCode&quot;</span><span class="token punctuation">,</span> to<span class="token punctuation">.</span>query<span class="token punctuation">.</span>access_code<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;exchange failed&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Whatever happens, go home.</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Now, press the Log In button again, allow the app to access your account and wait for the redirect to the app. Once it's done, you should have 2 variables stored in <code>localStorage</code>: <code>SpeckleDemo.Token</code> and <code>SpeckleDemo.RefreshToken</code></p> <p>At this point, we've managed to save our authentication token but our app still cannot discern if your users are authenticated or not (remember the <code>isAuthenticated</code> computed property in <code>App.vue</code>). We'll add this on the next step.</p> <h2 id="fetching-user-data"><a href="#fetching-user-data" class="header-anchor">#</a> Fetching user data</h2> <p>In order for our app to know <strong>who</strong> we are, it needs to fetch our user's data. The best place to fetch, and store, this data, is in our <code>store</code>.</p> <h3 id="user-data-query"><a href="#user-data-query" class="header-anchor">#</a> User data query</h3> <p>Add the following function to our <code>speckleQueries.js</code> file. This is the graphQL query that will fetch the user and server info.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">userInfoQuery</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">query {
      user {
        name
      },
      serverInfo {
        name
        company
      }
    }</span><span class="token template-punctuation string">`</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Add this to the <code>src/speckleUtils.js</code> file. Remember to import <code>userInfoQuery</code>.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> userInfoQuery <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/speckleQueries&quot;</span>

<span class="token comment">// Calls the GraphQL endpoint of the Speckle server with a specific query.</span>
<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">speckleFetch</span><span class="token punctuation">(</span><span class="token parameter">query</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> token <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token constant">TOKEN</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">)</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">SERVER_URL</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/graphql</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        method<span class="token operator">:</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span>
        headers<span class="token operator">:</span> <span class="token punctuation">{</span>
          Authorization<span class="token operator">:</span> <span class="token string">&quot;Bearer &quot;</span> <span class="token operator">+</span> token<span class="token punctuation">,</span>
          <span class="token string">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          query<span class="token operator">:</span> query
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;API call failed&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token keyword">else</span> <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">&quot;You are not logged in (token does not exist)&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Fetch the current user data using the userInfoQuery</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getUserData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">speckleFetch</span><span class="token punctuation">(</span><span class="token function">userInfoQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="modify-app-store"><a href="#modify-app-store" class="header-anchor">#</a> Modify app store</h3> <p>Replace the contents of your <code>src/store/index.js</code> with the following code:</p> <details class="custom-block details"><summary>store/index.js</summary> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">&quot;vuex&quot;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span>
  exchangeAccessCode<span class="token punctuation">,</span>
  getStreamCommits<span class="token punctuation">,</span>
  getUserData<span class="token punctuation">,</span>
  goToSpeckleAuthPage<span class="token punctuation">,</span>
  speckleLogOut
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/speckleUtils&quot;</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    serverInfo<span class="token operator">:</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  getters<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">isAuthenticated</span><span class="token operator">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>user <span class="token operator">!=</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">setUser</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>user <span class="token operator">=</span> user
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">setServerInfo</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>serverInfo <span class="token operator">=</span> info
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">logout</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Wipe the state</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setUser&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setServerInfo&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      <span class="token comment">// Wipe the tokens</span>
      <span class="token function">speckleLogOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">exchangeAccessCode</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> accessCode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Here, we could save the tokens to the store if necessary.</span>
      <span class="token keyword">return</span> <span class="token function">exchangeAccessCode</span><span class="token punctuation">(</span>accessCode<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">async</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> json <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getUserData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">var</span> data <span class="token operator">=</span> json<span class="token punctuation">.</span>data
        context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setUser&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
        context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setServerInfo&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>serverInfo<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">redirectToAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">goToSpeckleAuthPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  modules<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div></details> <h3 id="update-app-vue"><a href="#update-app-vue" class="header-anchor">#</a> Update <code>App.vue</code></h3> <p>Now, in the <code>App.vue</code> file, modify the <code>isAuthenticated</code> computed property as shown:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token function">isAuthenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>isAuthenticated
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Also, in the <code>template</code> section, add the following on top of the Login/Logout buttons</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isAuthenticated<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  Welcome
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>{{ $store.state.user.name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span>
  ! You are connected to
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>
    {{ $store.state.serverInfo.company }}'s
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>em</span><span class="token punctuation">&gt;</span></span>{{ $store.state.serverInfo.name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>em</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-spacer</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-spacer</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="update-router-beforeeach"><a href="#update-router-beforeeach" class="header-anchor">#</a> Update <code>router.beforeEach</code></h3> <p>The only thing left to do is to also tell the <code>router</code> to check the <code>user</code> on every page change. For this, modify the <code>beforeEach</code> implementation by adding an <code>else</code> clause to our previous condition</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>query<span class="token punctuation">.</span>access_code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// If the route contains an access code, exchange it</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">await</span> store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">&quot;exchangeAccessCode&quot;</span><span class="token punctuation">,</span> to<span class="token punctuation">.</span>query<span class="token punctuation">.</span>access_code<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;exchange failed&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Whatever happens, go home.</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">// Check on every route change if you still have access.</span>
      <span class="token keyword">var</span> goto <span class="token operator">=</span> <span class="token keyword">await</span> store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">&quot;getUser&quot;</span><span class="token punctuation">)</span>
      <span class="token function">next</span><span class="token punctuation">(</span>goto<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>That should do it! Now, if you refresh the page you should see a welcome message with your user name and the server name you connected to, as well as the <code>Log Out</code> button.</p> <h2 id="searching-for-streams"><a href="#searching-for-streams" class="header-anchor">#</a> Searching for streams</h2> <p>Now that we have access to our user and server data in our app, and also distinguish when a user is logged in or not, we can start fetching other info from our server. Let's start with a <strong>stream search</strong> field. The selected stream will also be stored in <code>vuex</code>, so we'll also add the appropriate state props, methods and actions to it.</p> <h3 id="search-query"><a href="#search-query" class="header-anchor">#</a> Search query</h3> <p>Start by adding the following function to our <code>speckeQueries.js</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">streamSearchQuery</span> <span class="token operator">=</span> <span class="token parameter">search</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">query {
      streams(query: &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>search<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;) {
        totalCount
        cursor
        items {
          id
          name
          updatedAt
        }
      }
    }</span><span class="token template-punctuation string">`</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>Then add the following function to <code>speckleUtils.js</code>. We'll use it to fetch the search results in our <code>SpeckleSearch</code> component (2 steps bellow)</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">searchStreams</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token function">speckleFetch</span><span class="token punctuation">(</span><span class="token function">streamSearchQuery</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="modify-app-store-2"><a href="#modify-app-store-2" class="header-anchor">#</a> Modify app store</h3> <p>Modify <code>src/store/index.js</code> as shown in the following code block. We've just added a <code>currentStream</code> property to the state, a <code>setCurrentStream</code> mutation and two actions, <code>handleStreamSelection</code> and <code>clearStreamSelection</code>. This will allow us to save the user selection in our app state.</p> <details class="custom-block details"><summary>store/index.js</summary> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">&quot;vuex&quot;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span>
  exchangeAccessCode<span class="token punctuation">,</span>
  getUserData<span class="token punctuation">,</span>
  goToSpeckleAuthPage<span class="token punctuation">,</span>
  speckleLogOut
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/speckleUtils&quot;</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    serverInfo<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    currentStream<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  getters<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">isAuthenticated</span><span class="token operator">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>user <span class="token operator">!=</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">setUser</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>user <span class="token operator">=</span> user
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">setServerInfo</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>serverInfo <span class="token operator">=</span> info
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">setCurrentStream</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> stream</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>currentStream <span class="token operator">=</span> stream
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">logout</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Wipe the state</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setUser&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setServerInfo&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setCurrentStream&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      <span class="token comment">// Wipe the tokens</span>
      <span class="token function">speckleLogOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">exchangeAccessCode</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> accessCode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Here, we could save the tokens to the store if necessary.</span>
      <span class="token keyword">return</span> <span class="token function">exchangeAccessCode</span><span class="token punctuation">(</span>accessCode<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">async</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> json <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getUserData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">var</span> data <span class="token operator">=</span> json<span class="token punctuation">.</span>data
        context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setUser&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
        context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setServerInfo&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>serverInfo<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">redirectToAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">goToSpeckleAuthPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">handleStreamSelection</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> stream</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setCurrentStream&quot;</span><span class="token punctuation">,</span> stream<span class="token punctuation">)</span>

    <span class="token punctuation">}</span>
    <span class="token function">clearStreamSelection</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setCurrentStream&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  modules<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div></details> <h3 id="create-child-components"><a href="#create-child-components" class="header-anchor">#</a> Create child components</h3> <p>Now we'll create a new component called <code>SpeckleSearch.vue</code> to handle all the search UI in one place.</p> <details class="custom-block details"><summary>SpeckleSearch.vue</summary> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-autocomplete</span>
    <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectedSearchResult<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:items</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>streams.items<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:search-input.sync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>search<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">no-filter</span>
    <span class="token attr-name">counter</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">rounded</span>
    <span class="token attr-name">filled</span>
    <span class="token attr-name">dense</span>
    <span class="token attr-name">flat</span>
    <span class="token attr-name">hide-no-data</span>
    <span class="token attr-name">hide-details</span>
    <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Streams Search<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">item-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">item-value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">return-object</span>
    <span class="token attr-name">clearable</span>
    <span class="token attr-name">append-icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">@update:</span>search-input</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>debounceInput<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{ item }<span class="token punctuation">&quot;</span></span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>background<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-list-item-content</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-list-item-title</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-row</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pa-0 ma-0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            {{ item.name }}
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-spacer</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-spacer</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>streamid<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item.id }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-row</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-list-item-title</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-list-item-subtitle</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>caption<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          Updated
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeago</span> <span class="token attr-name">:datetime</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.updatedAt<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeago</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-list-item-subtitle</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-list-item-content</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-autocomplete</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> debounce <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;debounce&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> searchStreams <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/speckleUtils&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;StreamSearch&quot;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">data</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    search<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    streams<span class="token operator">:</span> <span class="token punctuation">{</span> items<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    selectedSearchResult<span class="token operator">:</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  watch<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">selectedSearchResult</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>search <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>streams<span class="token punctuation">.</span>items <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;selected&quot;</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">async</span> <span class="token function">fetchSearchResults</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>e <span class="token operator">||</span> e<span class="token operator">?.</span>length <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
      <span class="token keyword">var</span> json <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">searchStreams</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>streams <span class="token operator">=</span> json<span class="token punctuation">.</span>data<span class="token punctuation">.</span>streams
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    debounceInput<span class="token operator">:</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fetchSearchResults</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br></div></div></details> <p>Create also a simple <code>WelcomeView.vue</code> to show to our non-authenticated users.</p> <details class="custom-block details"><summary>WelcomeView.vue</summary> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-container</span>
    <span class="token attr-name">fill-height</span>
    <span class="token attr-name">fluid</span>
    <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>home flex-column justify-center align-center primary--text<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Welcome to the Speckle Demo App!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>This app part of our developer guides<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Please log in to access you Speckle data.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-container</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;WelcomeView&quot;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></details> <h3 id="update-home-vue"><a href="#update-home-vue" class="header-anchor">#</a> Update <code>Home.vue</code></h3> <p>Modify the <code>Home.vue</code> view.</p> <details class="custom-block details"><summary>Home.vue</summary> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>WelcomeView</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>!$store.getters.isAuthenticated<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-container</span> <span class="token attr-name">v-else</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>home pa-6<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stream-search</span>
      <span class="token attr-name">@selected</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$store.dispatch(<span class="token punctuation">'</span>handleStreamSelection<span class="token punctuation">'</span>, $event)<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt-6 primary--text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectedStream<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        {{ selectedStream.name }} ‚Äî {{ selectedStream.id }}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-btn</span>
          <span class="token attr-name">outlined</span>
          <span class="token attr-name">text</span>
          <span class="token attr-name">small</span>
          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ml-3<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">:href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>serverUrl + <span class="token punctuation">'</span>/streams/<span class="token punctuation">'</span> + selectedStream.id<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">&gt;</span></span>
          View in server
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-btn</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-btn</span>
          <span class="token attr-name">outlined</span>
          <span class="token attr-name">text</span>
          <span class="token attr-name">small</span>
          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ml-3<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>error<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$store.dispatch(<span class="token punctuation">'</span>clearStreamSelection<span class="token punctuation">'</span>)<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">&gt;</span></span>
          Clear selection
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-btn</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-else</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>em</span><span class="token punctuation">&gt;</span></span>No stream selected. Find one using the search bar üëÜüèº<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>em</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-container</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> StreamSearch <span class="token keyword">from</span> <span class="token string">&quot;@/components/StreamSearch&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;Home&quot;</span><span class="token punctuation">,</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span> WelcomeView<span class="token punctuation">,</span> StreamSearch <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">data</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      serverUrl<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_SERVER_URL</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">selectedStream</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>currentStream
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div></details> <h3 id="update-app-vue-2"><a href="#update-app-vue-2" class="header-anchor">#</a> Update <code>App.vue</code></h3> <p>In <code>App.vue</code> there is a commented line referencing the `<!---->. Uncomment it.</p> <h3 id="preview-results"><a href="#preview-results" class="header-anchor">#</a> Preview results</h3> <p>After making these changes, your app should display a welcome message when not logged in and the search bar and selection text when logged in:</p> <p>Introducing some text into the search bar should display a list of results in a dropdown. Selecting one of the result items will change the selection text from <code>No stream selected</code> to display the selected Stream name and id, as well as 2 buttons. The first one will take you to the stream page in the server, while the second one will clear the selection in the app state.</p> <p><img src="/assets/img/app-guide-stream-search.641f64ce.gif" alt=""></p> <h2 id="displaying-stream-commits"><a href="#displaying-stream-commits" class="header-anchor">#</a> Displaying stream commits</h2> <p>So far, we've managed to authenticate with our Speckle server, fetch user and server information and search for available streams, as well as storing the results in our app state.</p> <p>Now, let's use our <code>selectedStream</code> to display a table with all it's commits, as well as some data associated with each commit. Since the commit list can be rather large, we'll be adding basic pagination functionality to the table.</p> <p>For that, we'll need to fetch the commit data associated with the stream, modify our <code>store/index.js</code> to hold that new data, and add a table view with a column filter on <code>Home.vue</code></p> <h3 id="create-fetch-query"><a href="#create-fetch-query" class="header-anchor">#</a> Create fetch query</h3> <p>Let's start by adding a new query function to our <code>speckleQueries.js</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">streamCommitsQuery</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">streamId<span class="token punctuation">,</span> itemsPerPage<span class="token punctuation">,</span> cursor</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">query {
    stream(id: &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>streamId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;){
      commits(limit: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>itemsPerPage<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, cursor: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>
  cursor <span class="token operator">?</span> <span class="token string">'&quot;'</span> <span class="token operator">+</span> cursor <span class="token operator">+</span> <span class="token string">'&quot;'</span> <span class="token operator">:</span> <span class="token keyword">null</span>
<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">) {
        totalCount
        cursor
        items{
          id
          message
          branchName
          sourceApplication
          referencedObject
          authorName
          createdAt
        }
      }
    }
  }</span><span class="token template-punctuation string">`</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>And add the following to <code>speckleUtils.js</code> (remember to import the <code>streamCommitsQuery</code>)</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getStreamCommits</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">streamId<span class="token punctuation">,</span> itemsPerPage<span class="token punctuation">,</span> cursor</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">speckleFetch</span><span class="token punctuation">(</span><span class="token function">streamCommitsQuery</span><span class="token punctuation">(</span>streamId<span class="token punctuation">,</span> itemsPerPage<span class="token punctuation">,</span> cursor<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Notice that the query has a <code>cursor</code>. This is used to get successive <em>pages</em> of the commits list. There is a current limitation with the cursor, as it only allows to go <em>forward</em> in pages, not backward. To fix this, we'll keep track of these values in our store so we can have pagination going forward (we'll also keep the <code>itemsPerPage</code> value fixed to keep things simple).</p> <h2 id="update-store-index-js"><a href="#update-store-index-js" class="header-anchor">#</a> Update <code>store/index.js</code></h2> <p>Now, there's quite a bit of modifications in the <code>store/index.js</code> file. I've highlighted the changes in the code block, but feel free to replace the whole content for the one bellow.</p> <p>We basically need modify the state to be able to:</p> <ul><li>Store the <code>latestCommits</code> data, a list of <code>previousCursors</code> and a list of <code>tableOptions</code> for the table visualization.</li> <li>Add mutations to modify individually each of these state properties (note that <code>previousCursors</code> is a list, so we added two mutations: one to push a new value and another to replace the entire list)</li> <li>Add <code>getCommits</code> action, and update <code>logout</code>, <code>handleStreamSelection</code> and <code>clearStreamSelection</code> to also deal with these new props.</li></ul> <details class="custom-block details"><summary>router/index.js</summary> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">&quot;vuex&quot;</span>
<span class="token keyword">import</span> VuexPersistence <span class="token keyword">from</span> <span class="token string">&quot;vuex-persist&quot;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span>
  <span class="token constant">APP_NAME</span><span class="token punctuation">,</span>
  exchangeAccessCode<span class="token punctuation">,</span>
  getStreamCommits<span class="token punctuation">,</span>
  getUserData<span class="token punctuation">,</span>
  goToSpeckleAuthPage<span class="token punctuation">,</span>
  speckleLogOut
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/speckleUtils&quot;</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span>

<span class="token keyword">const</span> vuexLocal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VuexPersistence</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  storage<span class="token operator">:</span> window<span class="token punctuation">.</span>localStorage<span class="token punctuation">,</span>
  key<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">APP_NAME</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.vuex</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>vuexLocal<span class="token punctuation">.</span>plugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    serverInfo<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    currentStream<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    latestCommits<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    previousCursors<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">null</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    tableOptions<span class="token operator">:</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  getters<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">isAuthenticated</span><span class="token operator">:</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>user <span class="token operator">!=</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">setUser</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>user <span class="token operator">=</span> user
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">setServerInfo</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>serverInfo <span class="token operator">=</span> info
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">setCurrentStream</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> stream</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>currentStream <span class="token operator">=</span> stream
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">setCommits</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> commits</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>latestCommits <span class="token operator">=</span> commits
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">setTableOptions</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>tableOptions <span class="token operator">=</span> options
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">resetPrevCursors</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>previousCursors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">null</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">addCursorToPreviousList</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> cursor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>previousCursors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cursor<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">logout</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Wipe the state</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setUser&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setServerInfo&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setCurrentStream&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setCommits&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setTableOptions&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;resetPrevCursors&quot;</span><span class="token punctuation">)</span>
      <span class="token comment">// Wipe the tokens</span>
      <span class="token function">speckleLogOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">exchangeAccessCode</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> accessCode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Here, we could save the tokens to the store if necessary.</span>
      <span class="token keyword">return</span> <span class="token function">exchangeAccessCode</span><span class="token punctuation">(</span>accessCode<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">async</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> json <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getUserData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">var</span> data <span class="token operator">=</span> json<span class="token punctuation">.</span>data
        context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setUser&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
        context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setServerInfo&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>serverInfo<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">redirectToAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">goToSpeckleAuthPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">async</span> <span class="token function">handleStreamSelection</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> stream</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setCurrentStream&quot;</span><span class="token punctuation">,</span> stream<span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setTableOptions&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> itemsPerPage<span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;resetPrevCursors&quot;</span><span class="token punctuation">)</span>
      <span class="token keyword">var</span> json <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getStreamCommits</span><span class="token punctuation">(</span>stream<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setCommits&quot;</span><span class="token punctuation">,</span> json<span class="token punctuation">.</span>data<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>commits<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">async</span> <span class="token function">getCommits</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> cursor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> json <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getStreamCommits</span><span class="token punctuation">(</span>
        context<span class="token punctuation">.</span>state<span class="token punctuation">.</span>currentStream<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
        <span class="token number">5</span><span class="token punctuation">,</span>
        cursor
      <span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setCommits&quot;</span><span class="token punctuation">,</span> json<span class="token punctuation">.</span>data<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>commits<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">clearStreamSelection</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setCurrentStream&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setCommits&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setTableOptions&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;resetPrevCursors&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword">null</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  modules<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br></div></div></details> <h2 id="update-home-vue-2"><a href="#update-home-vue-2" class="header-anchor">#</a> Update <code>Home.vue</code></h2> <p>The <code>Home.vue</code> also requires some major additions, so I've highlighted the changes in the code block, but just as the step below, feel free to replace the entire content if you're playing it fast and loose!</p> <p>We need to do the following modifications:</p> <ul><li>Add a new <code>div</code> for the table view containing a <code>v-select</code> and a <code>v-data-table</code>.
<ul><li>The <code>v-select</code> allows to select the available keys to display as table columns</li> <li>The <code>v-data-table</code> does all the table UI magic so we don't have to.</li></ul></li> <li>Add several computed properties:
<ul><li><code>commits</code> and <code>previousCursors</code> to fetch the data from our store</li> <li><code>availableKeys</code> and <code>filteredHeaders</code> are helper functions to extract all available keys from the received commit data and format the headers the way <code>v-data-table</code> likes them.</li></ul></li> <li>Add new data properties to the component:
<ul><li><code>options</code> will serve to keep the table options in sync</li> <li><code>selectedKeys</code> is where we'll save the user selected information to display as columns in the table. It is initialized with some values already.</li></ul></li> <li>Add a <strong>watch</strong> function for <code>options</code>:
<ul><li>I will get called every time the table options change. This is where we check if a page change has been requested, and tell the store to fetch new data if necessary.</li></ul></li> <li>We also added some css magic to hide the <code>itemsPerPage</code> selection button, as this demo will have a fixed page size.</li></ul> <details class="custom-block details"><summary>Home.vue</summary> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>WelcomeView</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>!$store.getters.isAuthenticated<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-container</span> <span class="token attr-name">v-else</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>home pa-6<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stream-search</span>
      <span class="token attr-name">@selected</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$store.dispatch(<span class="token punctuation">'</span>handleStreamSelection<span class="token punctuation">'</span>, $event)<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt-6 primary--text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectedStream<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        {{ selectedStream.name }} ‚Äî {{ selectedStream.id }}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-btn</span>
          <span class="token attr-name">outlined</span>
          <span class="token attr-name">text</span>
          <span class="token attr-name">small</span>
          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ml-3<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">:href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>serverUrl + <span class="token punctuation">'</span>/streams/<span class="token punctuation">'</span> + selectedStream.id<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">&gt;</span></span>
          View in server
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-btn</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-btn</span>
          <span class="token attr-name">outlined</span>
          <span class="token attr-name">text</span>
          <span class="token attr-name">small</span>
          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ml-3<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>error<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$store.dispatch(<span class="token punctuation">'</span>clearStreamSelection<span class="token punctuation">'</span>)<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">&gt;</span></span>
          Clear selection
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-btn</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-else</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>em</span><span class="token punctuation">&gt;</span></span>No stream selected. Find one using the search bar üëÜüèº<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>em</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pt-6<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-select</span>
        <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectedKeys<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:items</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>availableKeys<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">chips</span>
        <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Select data to display<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">multiple</span>
      <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-select</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pa-2 primary--text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Stream commits:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-data-table</span>
        <span class="token attr-name">:loading</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loading<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:headers</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>filteredHeaders<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:items</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>commits ? commits.items : []<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:options.sync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>options<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:server-items-length</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>commits ? commits.totalCount : null<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">disable-sort</span>
        <span class="token attr-name">disable-filtering</span>
        <span class="token attr-name">:disable-pagination</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loading<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>elevation-1<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-data-table</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-container</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> StreamSearch <span class="token keyword">from</span> <span class="token string">&quot;@/components/StreamSearch&quot;</span>
<span class="token keyword">import</span> WelcomeView <span class="token keyword">from</span> <span class="token string">&quot;@/components/WelcomeView&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;Home&quot;</span><span class="token punctuation">,</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span> WelcomeView<span class="token punctuation">,</span> StreamSearch <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">data</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      loading<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        itemsPerPage<span class="token operator">:</span> <span class="token number">5</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      serverUrl<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_SERVER_URL</span><span class="token punctuation">,</span>
      selectedKeys<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;branchName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;authorName&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> storedOpts <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>tableOptions
    <span class="token keyword">if</span> <span class="token punctuation">(</span>storedOpts<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> storedOpts
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">selectedStream</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>currentStream
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">previousCursors</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>previousCursors <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token keyword">null</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">commits</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>latestCommits
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">availableKeys</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> keys <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>commits<span class="token operator">?.</span>items<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>keys<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            keys<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>keys<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">filteredHeaders</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectedKeys<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> key<span class="token punctuation">,</span> value<span class="token operator">:</span> key <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  watch<span class="token operator">:</span> <span class="token punctuation">{</span>
    options<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">async</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> oldval</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setTableOptions&quot;</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldval<span class="token punctuation">.</span>page <span class="token operator">&amp;&amp;</span> val<span class="token punctuation">.</span>page <span class="token operator">!=</span> oldval<span class="token punctuation">.</span>page<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">.</span>page <span class="token operator">&gt;</span> oldval<span class="token punctuation">.</span>page<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">true</span>
            <span class="token keyword">var</span> cursor <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>latestCommits<span class="token punctuation">.</span>cursor
            <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">&quot;getCommits&quot;</span><span class="token punctuation">,</span> cursor<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;addCursorToPreviousList&quot;</span><span class="token punctuation">,</span> cursor<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;page down&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">true</span>
            <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>
              <span class="token string">&quot;getCommits&quot;</span><span class="token punctuation">,</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span>previousCursors<span class="token punctuation">[</span>val<span class="token punctuation">.</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
            <span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">false</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      deep<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">#viewer</span> <span class="token punctuation">{</span>
  <span class="token property">min-height</span><span class="token punctuation">:</span> 500px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.v-data-footer__select</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> none <span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br></div></div></details> <h2 id="preview-result"><a href="#preview-result" class="header-anchor">#</a> Preview result</h2> <p>That should cover all the changes needed! Go ahead to <a href="https://localhost:8080" target="_blank" rel="noopener noreferrer">http://localhost:8080<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. If logged in, your app should be looking like this üëáüèº</p> <p><img src="/assets/img/app-guide-full-demo.1024d106.gif" alt=""></p> <h2 id="adding-data-persistence"><a href="#adding-data-persistence" class="header-anchor">#</a> Adding data persistence</h2> <p>Our app seems to be working fine, but there's still a small adjustment that we can do to make things better. If, for any reason, a user reloads the page, they will loose their current stream selection + commit results, which is annoying. Let's fix that!</p> <p>Thankfully, we only need to modify the <code>store/index.js</code> file slightly to make this happen. We already installed <code>vuex-persist</code>, the plugin that will do all the heavy lifting for us.</p> <p>First, import vuex-persist:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> VuexPersistence <span class="token keyword">from</span> <span class="token string">&quot;vuex-persist&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>then create an instance (you'll need to import <code>APP_NAME</code> from <code>speckleUtils.js</code>) that uses <code>localStorage</code>. We could also use <code>sessionStorage</code>, which would be deleted at the end of the session.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> vuexLocal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VuexPersistence</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  storage<span class="token operator">:</span> window<span class="token punctuation">.</span>localStorage<span class="token punctuation">,</span>
  key<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">APP_NAME</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.vuex</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>add a <code>plugins</code> property to the <code>Vuex.Store</code> constructor config:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>vuexLocal<span class="token punctuation">.</span>plugin<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>and that's it! Your app should now persist the app state across page refresh. üöÄ</p> <h2 id="publish-to-netlify"><a href="#publish-to-netlify" class="header-anchor">#</a> Publish to Netlify</h2> <p>Now that we have our app up and running locally, there's just one last thing to do: deploy it!</p> <p>We'll be using Netlify for this guide, but you could also as easily use Heroku, or any other platforms that supports web-app s like Vue.js out of the box.</p> <p>First, you'll need a GitHub account to push your app's repo to, and a Netlify account. If you haven't got a netlify account yet, you can log in with your GitHub account, which will make your life easier.</p> <h3 id="create-your-site"><a href="#create-your-site" class="header-anchor">#</a> Create your site</h3> <ol><li>Go to your Netlify's dashboard and find the <code>New site from Git</code> button
<img src="/assets/img/app-guide-netlify-new-site.88cb7d26.png" alt=""></li> <li>Follow the steps as shown:
<ol><li><img src="/assets/img/app-guide-netlify-new-site-2.1f6bdff9.png" alt=""></li> <li><img src="/assets/img/app-guide-netlify-new-site-3.d288f521.png" alt=""></li> <li><img src="/assets/img/app-guide-netlify-new-site-4.ca2b8d4b.png" alt=""></li> <li>Once this is done, you'll have a netlify url where you're app will live.</li></ol></li> <li>Create a new Application on the Speckle server and set it's callback url to the application url you just got from Netlify. This will give you a new <code>appId</code> and <code>appSecret</code>.</li> <li>Last step is to set the <code>env</code> variables, similar to how we did it for our development server.
<ol><li>Go to <code>Site Settings</code>-&gt;<code>Build and Deploy</code>-<code>Environment</code></li> <li>Add the same environment variables as in your <code>.env.local</code> file but using the <code>appId</code> and <code>appSecret</code> values from step 3.
<img src="/assets/img/app-guide-netlify-env.167695cc.png" alt=""></li></ol></li> <li>Go to the <code>Deploys</code> section of your app, find the <code>Trigger Deploy</code> button and select the <code>Deploy Site</code> option. This will force your app to restart and detect the new env variables.</li></ol> <p>That's it! If you visit your netlify url, you should see your app running smoothly!</p> <h2 id="wrapping-it-up"><a href="#wrapping-it-up" class="header-anchor">#</a> Wrapping it up</h2> <p>We've covered quite a lot on this guide, but this was only <strong>Part 1</strong>! Stay tuned for our following releases, where we'll also use our web viewer, fetch the data inside commits, receive notifications from the server, and more!</p> <div class="custom-block tip"><p class="custom-block-title">Code Repository</p> <p>You can find the entire code for this guide <a href="https://github.com/specklesystems/speckle-demo-app" target="_blank" rel="noopener noreferrer">in this repository.<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <p>If you find any issues with this guide, or the apps code, feel free to report them on our <a href="https://speckle.community" target="_blank" rel="noopener noreferrer">Community Forum<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or directly on the app's GitHub repo. Wherever it feels more appropriate.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/specklesystems/speckle-docs/edit/main/dev/apps.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/1/2021, 7:20:52 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ‚Üê
      <a href="/dev/tokens.html" class="prev">
        Personal Access Tokens
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.99a85e76.js" defer></script><script src="/assets/js/4.4326cdb2.js" defer></script><script src="/assets/js/8.34516b02.js" defer></script>
  </body>
</html>
