<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tutorial: Simple Dashboard | Speckle Docs</title>
    <meta name="generator" content="VuePress 1.8.2">
    <script src="/scripts/scroll-to-hash.js"></script>
    <meta name="description" content="Documentation on everything Speckle">
    <meta name="theme-color" content="#0480FB">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.df7ac8e6.css" as="style"><link rel="preload" href="/assets/js/app.99a85e76.js" as="script"><link rel="preload" href="/assets/js/4.4326cdb2.js" as="script"><link rel="preload" href="/assets/js/17.0ca52ce1.js" as="script"><link rel="preload" href="/assets/js/27.f73e931d.js" as="script"><link rel="prefetch" href="/assets/js/10.3e7ac9b8.js"><link rel="prefetch" href="/assets/js/11.a4694f2f.js"><link rel="prefetch" href="/assets/js/12.c114fb3d.js"><link rel="prefetch" href="/assets/js/13.7cc92742.js"><link rel="prefetch" href="/assets/js/14.f4163000.js"><link rel="prefetch" href="/assets/js/15.2efb9a44.js"><link rel="prefetch" href="/assets/js/16.21572a9c.js"><link rel="prefetch" href="/assets/js/18.156d8e4d.js"><link rel="prefetch" href="/assets/js/19.ae2b9c8c.js"><link rel="prefetch" href="/assets/js/20.ee5275bb.js"><link rel="prefetch" href="/assets/js/21.60e9f828.js"><link rel="prefetch" href="/assets/js/22.9780a091.js"><link rel="prefetch" href="/assets/js/23.3af4e7e3.js"><link rel="prefetch" href="/assets/js/24.0b6908e4.js"><link rel="prefetch" href="/assets/js/25.15884d28.js"><link rel="prefetch" href="/assets/js/26.4182a715.js"><link rel="prefetch" href="/assets/js/28.526514f8.js"><link rel="prefetch" href="/assets/js/29.254ef804.js"><link rel="prefetch" href="/assets/js/3.2c817222.js"><link rel="prefetch" href="/assets/js/30.7b9c4b8b.js"><link rel="prefetch" href="/assets/js/31.0ae384c7.js"><link rel="prefetch" href="/assets/js/32.ff7dc8a3.js"><link rel="prefetch" href="/assets/js/33.22ee2056.js"><link rel="prefetch" href="/assets/js/34.32233c9e.js"><link rel="prefetch" href="/assets/js/35.87aa89ee.js"><link rel="prefetch" href="/assets/js/36.a1e3d380.js"><link rel="prefetch" href="/assets/js/37.121a0a1c.js"><link rel="prefetch" href="/assets/js/38.6270b359.js"><link rel="prefetch" href="/assets/js/39.72767cb8.js"><link rel="prefetch" href="/assets/js/40.d2261fc4.js"><link rel="prefetch" href="/assets/js/41.3b2b05a8.js"><link rel="prefetch" href="/assets/js/42.c88af68f.js"><link rel="prefetch" href="/assets/js/43.47abbed9.js"><link rel="prefetch" href="/assets/js/44.125e48f0.js"><link rel="prefetch" href="/assets/js/45.1c8bf8c8.js"><link rel="prefetch" href="/assets/js/46.e76c532e.js"><link rel="prefetch" href="/assets/js/47.19a7f421.js"><link rel="prefetch" href="/assets/js/48.33e9e938.js"><link rel="prefetch" href="/assets/js/49.c89f1432.js"><link rel="prefetch" href="/assets/js/5.6a902ace.js"><link rel="prefetch" href="/assets/js/50.35f05f89.js"><link rel="prefetch" href="/assets/js/51.f1a6f631.js"><link rel="prefetch" href="/assets/js/52.e7cf1987.js"><link rel="prefetch" href="/assets/js/53.5137e2c4.js"><link rel="prefetch" href="/assets/js/54.f9641ffa.js"><link rel="prefetch" href="/assets/js/55.3e64c05b.js"><link rel="prefetch" href="/assets/js/56.3a1b3c96.js"><link rel="prefetch" href="/assets/js/57.0255fe1f.js"><link rel="prefetch" href="/assets/js/58.78203d8e.js"><link rel="prefetch" href="/assets/js/59.e0afe630.js"><link rel="prefetch" href="/assets/js/6.42ae08b8.js"><link rel="prefetch" href="/assets/js/60.d648178f.js"><link rel="prefetch" href="/assets/js/61.ba653bbd.js"><link rel="prefetch" href="/assets/js/62.25d813a4.js"><link rel="prefetch" href="/assets/js/63.f9688f43.js"><link rel="prefetch" href="/assets/js/64.d6f115ed.js"><link rel="prefetch" href="/assets/js/65.36f31357.js"><link rel="prefetch" href="/assets/js/7.a2af4118.js"><link rel="prefetch" href="/assets/js/8.34516b02.js"><link rel="prefetch" href="/assets/js/9.d41b359b.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.4b331d06.js">
    <link rel="stylesheet" href="/assets/css/0.styles.df7ac8e6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/logo-docs.png" alt="Speckle Docs" class="logo"> <span class="site-name can-hide">Speckle Docs</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  User Guide
</a></div><div class="nav-item"><a href="/dev/" class="nav-link router-link-active">
  Developer Docs
</a></div><div class="nav-item"><a href="https://speckle.systems" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Speckle Website
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://speckle.systems/getstarted/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Get Started
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/specklesystems/speckle-docs/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  User Guide
</a></div><div class="nav-item"><a href="/dev/" class="nav-link router-link-active">
  Developer Docs
</a></div><div class="nav-item"><a href="https://speckle.systems" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Speckle Website
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://speckle.systems/getstarted/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Get Started
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/specklesystems/speckle-docs/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Developer Docs 👩‍💻</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/dev/architecture.html" class="sidebar-link">Architecture</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Core Concepts</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/base.html" class="sidebar-link">The Base Object</a></li><li><a href="/dev/decomposition.html" class="sidebar-link">Decomposition API</a></li><li><a href="/dev/kits.html" class="sidebar-link">Kits</a></li><li><a href="/dev/transports.html" class="sidebar-link">Transports</a></li><li><a href="/dev/apps-auth.html" class="sidebar-link">Apps &amp; Auth</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Advanced Concepts</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>.NET SDK</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/dotnet.html" class="sidebar-link">Introduction</a></li><li><a href="/dev/objects.html" class="sidebar-link">Objects Kit</a></li><li><a href="/dev/connectors-dev.html" class="sidebar-link">Writing Your Own connector</a></li><li><a href="/dev/kits-dev.html" class="sidebar-link">Writing Your Own Kit</a></li><li><a href="/dev/transports-dev.html" class="sidebar-link">Writing Your Own Transport</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Python SDK</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/python.html" class="sidebar-link">Introduction</a></li><li><a href="/dev/py-examples.html" class="sidebar-link">Examples</a></li><li><a href="/dev/py-sample.html" aria-current="page" class="active sidebar-link">Tutorial: Simple Dashboard</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dev/py-sample.html#receive-objects-from-the-server" class="sidebar-link">Receive Objects From The Server</a></li><li class="sidebar-sub-header"><a href="/dev/py-sample.html#update-existing-objects" class="sidebar-link">Update Existing Objects</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dev/py-sample.html#subclassing-base" class="sidebar-link">Subclassing Base</a></li><li class="sidebar-sub-header"><a href="/dev/py-sample.html#sending-to-the-stream" class="sidebar-link">Sending to the Stream</a></li></ul></li><li class="sidebar-sub-header"><a href="/dev/py-sample.html#do-cool-stuff" class="sidebar-link">Do Cool Stuff</a></li><li class="sidebar-sub-header"><a href="/dev/py-sample.html#conclusion" class="sidebar-link">Conclusion</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Javascript SDK</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/js.html" class="sidebar-link">Introduction</a></li><li><a href="/dev/viewer.html" class="sidebar-link">Using our embeddable 3D viewer</a></li><li><a href="/dev/js-app-script.html" class="sidebar-link">Using Google Apps Scripts</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Server API &amp; Apps</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev/server-api.html" class="sidebar-link">Introduction</a></li><li><a href="/dev/server-graphql-api.html" class="sidebar-link">GraphQL API</a></li><li><a href="/dev/server-rest-api.html" class="sidebar-link">REST API</a></li><li><a href="/dev/server-webhooks.html" class="sidebar-link">Webhooks</a></li><li><a href="/dev/server-setup.html" class="sidebar-link">Deploying a Server - DigitalOcean Marketplace App</a></li><li><a href="/dev/server-manualsetup.html" class="sidebar-link">Deploying a Server - manual setup</a></li><li><a href="/dev/tokens.html" class="sidebar-link">Personal Access Tokens</a></li><li><a href="/dev/apps.html" class="sidebar-link">Creating Your Own App</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="tutorial-simple-dashboard"><a href="#tutorial-simple-dashboard" class="header-anchor">#</a> Tutorial: Simple Dashboard</h1> <p>In this tutorial, we'll be working with Speckle data and using it to create a super simple dashboard. We'll be receiving geometry from a stream, updating the data, and using it to do some calculations and simple plots using Plotly and Dash.</p> <p><img src="/assets/img/pysample-dashboard.d6c2f3a2.gif" alt=""></p> <p>We will assume you have general knowledge of Python and Speckle. If anything trips you up, have a look back at the <a href="/dev/py-examples">Python examples</a> or the <a href="/user/concepts">Speckle Concepts</a>.</p> <p>If you want to follow along with the code, the repo for this project can be found <a href="https://github.com/izzylys/demo-specklepy" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="receive-objects-from-the-server"><a href="#receive-objects-from-the-server" class="header-anchor">#</a> Receive Objects From The Server</h2> <p>If you've already been through the <a href="/dev/py-examples">Python examples</a>, you'll already know how to receive objects from the server. As a refresher, you'll need to create a <code>SpeckleClient</code> which serves as your entry point to the API. We then authenticate this client using a token from a local account. If you haven't used the <a href="/user/manager">Manager</a> to add a local account, you can go to <code>your-server.com/profile</code> and create a Personal Access Token to use here. We'll then use this client to get the commit we're interested in.</p> <p>In this case, we're going to be looking at this twisty building Alan generated in Grasshopper and send to Speckle using the <a href="/user/grasshopper">Grasshopper Connector</a>. It has 10 levels split into separate objects each containing fields for facades, columns, banisters, and floor slabs.</p> <p><img src="/assets/img/pysample-gh-commit.4e610fcb.gif" alt=""></p> <p>The snippet below shows how you would authenticate the client, get the commit we're interested in, and use a server transport to receive the commit object.</p> <div class="language-py line-numbers-mode"><pre class="language-py"><code><span class="token keyword">from</span> specklepy<span class="token punctuation">.</span>api <span class="token keyword">import</span> operations
<span class="token keyword">from</span> specklepy<span class="token punctuation">.</span>api<span class="token punctuation">.</span>client <span class="token keyword">import</span> SpeckleClient
<span class="token keyword">from</span> specklepy<span class="token punctuation">.</span>api<span class="token punctuation">.</span>credentials <span class="token keyword">import</span> get_default_account
<span class="token keyword">from</span> specklepy<span class="token punctuation">.</span>transports<span class="token punctuation">.</span>server <span class="token keyword">import</span> ServerTransport

<span class="token comment"># create and authenticate a client</span>
client <span class="token operator">=</span> SpeckleClient<span class="token punctuation">(</span>host<span class="token operator">=</span>HOST<span class="token punctuation">)</span>
account <span class="token operator">=</span> get_default_account<span class="token punctuation">(</span><span class="token punctuation">)</span>
client<span class="token punctuation">.</span>authenticate<span class="token punctuation">(</span>token<span class="token operator">=</span>account<span class="token punctuation">.</span>token<span class="token punctuation">)</span>

<span class="token comment"># get the specified commit data</span>
commit <span class="token operator">=</span> client<span class="token punctuation">.</span>commit<span class="token punctuation">.</span>get<span class="token punctuation">(</span>STREAM_ID<span class="token punctuation">,</span> COMMIT_ID<span class="token punctuation">)</span>

<span class="token comment"># create an authenticated server transport from the client and receive the commit obj</span>
transport <span class="token operator">=</span> ServerTransport<span class="token punctuation">(</span>client<span class="token punctuation">,</span> STREAM_ID<span class="token punctuation">)</span>
res <span class="token operator">=</span> operations<span class="token punctuation">.</span>receive<span class="token punctuation">(</span>commit<span class="token punctuation">.</span>referencedObject<span class="token punctuation">,</span> transport<span class="token punctuation">)</span>

<span class="token comment"># get the list of levels from the received object</span>
levels <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="update-existing-objects"><a href="#update-existing-objects" class="header-anchor">#</a> Update Existing Objects</h2> <p>Now that we've received this building from Grasshopper, let's make some modifications. The data has already been structured nicely into a list of <code>Base</code> objects each representing a level. Each level has attributes containing that level's facade, columns, banister, and floor slab.</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span>  <span class="token string">&quot;idfcaf8b9e145241dsdfa915885d87cda2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;speckle_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Base&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span>  <span class="token string">&quot;ide6acabd37e865ce87a5sdf444d733877&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;speckle_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Base&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;@facade&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span> ... <span class="token punctuation">}</span><span class="token punctuation">,</span> ... <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;@columns&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span> ... <span class="token punctuation">}</span><span class="token punctuation">,</span> ... <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;@banister&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> ... <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;@floorSlab&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> ... <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            ...
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>Let's say we want to do some estimated embodied carbon calculations. However, currently no material information has been added to the elements in the stream. We can add this ourselves and update the stream for the rest of the team.</p> <h3 id="subclassing-base"><a href="#subclassing-base" class="header-anchor">#</a> Subclassing Base</h3> <p>To do this, let's create classes for each material and add these materials to a &quot;material&quot; attribute on each object within the stream. Obviously, this is a bit of an over the top example. It would be more efficient to just add a string attribute to each object that indicates the material, then look up the material properties from a database when running the calculations. However, I want to have some fun here and show you some of the cool things you can do with the <code>Base</code> class!</p> <p>Let's start with defining our materials as <code>Base</code> subclasses. This ensures they'll be serialised correctly and that they'll be picked up by the <code>Base</code> type registry. We can then create a mapping for each element type name to the <code>speckle_type</code> of the corresponding material class. The <code>speckle_type</code> is prepopulated by the class and defaults to the class name.</p> <div class="language-py line-numbers-mode"><pre class="language-py"><code><span class="token comment"># density (kg/m^3) and embodied carbon (kg CO^2/kg) estimates</span>
<span class="token comment"># from https://www.greenspec.co.uk/building-design/embodied-energy/</span>
<span class="token keyword">class</span> <span class="token class-name">Concrete</span><span class="token punctuation">(</span>Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
    density<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token number">2400</span>
    embodied_carbon <span class="token operator">=</span> <span class="token number">0.159</span>


<span class="token keyword">class</span> <span class="token class-name">Glass</span><span class="token punctuation">(</span>Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
    density<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token number">2500</span>
    embodied_carbon <span class="token operator">=</span> <span class="token number">0.85</span>


<span class="token keyword">class</span> <span class="token class-name">Steel</span><span class="token punctuation">(</span>Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
    density<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token number">7800</span>
    embodied_carbon <span class="token operator">=</span> <span class="token number">1.37</span>


MATERIALS_MAPPING <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;@floorSlab&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Concrete&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;@banister&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Glass&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;@facade&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Glass&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;@columns&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Steel&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>We can now write a function that iterates through all the members of a level and adds a material if it exists in our mapping.</p> <div class="language-py line-numbers-mode"><pre class="language-py"><code><span class="token keyword">def</span> <span class="token function">add_materials_data</span><span class="token punctuation">(</span>level<span class="token punctuation">:</span> Base<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Base<span class="token punctuation">:</span>
    <span class="token comment"># first, get all the attribute names</span>
    names <span class="token operator">=</span> level<span class="token punctuation">.</span>get_member_names<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># then iterate through them to check if they exist in our mapping</span>
    <span class="token keyword">for</span> name <span class="token keyword">in</span> names<span class="token punctuation">:</span>
        <span class="token keyword">if</span> name <span class="token keyword">not</span> <span class="token keyword">in</span> MATERIALS_MAPPING<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
        <span class="token comment"># if they do, use this class method to get the class and init it</span>
        material <span class="token operator">=</span> Base<span class="token punctuation">.</span>get_registered_type<span class="token punctuation">(</span>MATERIALS_MAPPING<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># now we can add a `@material` attribute dynamically to each object.</span>
        <span class="token comment"># note that we're making it detachable with the `@`</span>
        prop <span class="token operator">=</span> level<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>prop<span class="token punctuation">,</span> Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
            prop<span class="token punctuation">[</span><span class="token string">&quot;@material&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> material
        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>prop<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> item <span class="token keyword">in</span> prop<span class="token punctuation">:</span>
                item<span class="token punctuation">[</span><span class="token string">&quot;@material&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> material
    <span class="token keyword">return</span> level
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>Note that we've added a <em>detached</em> dynamic attribute called <code>@material</code> to each element we are interested in. We've marked it as detachable (prepended with an <code>@</code>) so we don't store hundreds of copies of the same materials classes in this stream. Each instance of each materials class in our case is the same, so we only need to store each once. However, we want to reference them within multiple elements. Using a detachable attribute is the solution! You get a reference for the correct material object in each element, but you only store unique objects (in our case, one instance of each material class) in the stream.</p> <h3 id="sending-to-the-stream"><a href="#sending-to-the-stream" class="header-anchor">#</a> Sending to the Stream</h3> <p>We can now use the <code>add_materials_data()</code> method we wrote to update all the levels in the stream and send these updated levels back. Let's add on to what we've already written.</p> <p>To send our updated building, we'll need to create a parent <code>Base</code> and place our list of nested levels inside this parent. To keep things consistent, we'll be adding them to a field called <code>data</code>.</p> <div class="language-py line-numbers-mode"><pre class="language-py"><code><span class="token keyword">from</span> specklepy<span class="token punctuation">.</span>objects <span class="token keyword">import</span> Base

<span class="token comment"># add the materials data to our levels</span>
levels <span class="token operator">=</span> <span class="token punctuation">[</span>add_materials_data<span class="token punctuation">(</span>level<span class="token punctuation">)</span> <span class="token keyword">for</span> level <span class="token keyword">in</span> levels<span class="token punctuation">]</span>

<span class="token comment"># create a base object to hold the list of levels</span>
base <span class="token operator">=</span> Base<span class="token punctuation">(</span>data<span class="token operator">=</span>levels<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>We'll then use <code>operations.send()</code> to send this object to the stream, then use <code>client.commit.create()</code> to commit our changes to the stream. If we want to send to a new branch, we can do so by first creating one using <code>client.branch.create(stream_id, name, description)</code>. The snippet below shows this full process.</p> <div class="language-py line-numbers-mode"><pre class="language-py"><code><span class="token comment"># recap from earlier</span>
client <span class="token operator">=</span> SpeckleClient<span class="token punctuation">(</span>host<span class="token operator">=</span>HOST<span class="token punctuation">)</span>
account <span class="token operator">=</span> get_default_account<span class="token punctuation">(</span><span class="token punctuation">)</span>
client<span class="token punctuation">.</span>authenticate<span class="token punctuation">(</span>token<span class="token operator">=</span>account<span class="token punctuation">.</span>token<span class="token punctuation">)</span>

commit <span class="token operator">=</span> client<span class="token punctuation">.</span>commit<span class="token punctuation">.</span>get<span class="token punctuation">(</span>STREAM_ID<span class="token punctuation">,</span> COMMIT_ID<span class="token punctuation">)</span>

transport <span class="token operator">=</span> ServerTransport<span class="token punctuation">(</span>client<span class="token punctuation">,</span> STREAM_ID<span class="token punctuation">)</span>
res <span class="token operator">=</span> operations<span class="token punctuation">.</span>receive<span class="token punctuation">(</span>commit<span class="token punctuation">.</span>referencedObject<span class="token punctuation">,</span> transport<span class="token punctuation">)</span>

<span class="token comment"># get the list of levels from the received object</span>
levels <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">]</span>

<span class="token comment"># add the materials data to our levels</span>
levels <span class="token operator">=</span> <span class="token punctuation">[</span>add_materials_data<span class="token punctuation">(</span>level<span class="token punctuation">)</span> <span class="token keyword">for</span> level <span class="token keyword">in</span> levels<span class="token punctuation">]</span>

<span class="token comment"># create a branch if you'd like</span>
branch_name <span class="token operator">=</span> <span class="token string">&quot;🐍 demo&quot;</span>
branches <span class="token operator">=</span> client<span class="token punctuation">.</span>branch<span class="token punctuation">.</span><span class="token builtin">list</span><span class="token punctuation">(</span>STREAM_ID<span class="token punctuation">)</span>
has_res_branch <span class="token operator">=</span> <span class="token builtin">any</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>name <span class="token operator">==</span> branch_name <span class="token keyword">for</span> b <span class="token keyword">in</span> branches<span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> has_res_branch<span class="token punctuation">:</span>
    client<span class="token punctuation">.</span>branch<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
        STREAM_ID<span class="token punctuation">,</span> name<span class="token operator">=</span>branch_name<span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">&quot;new stuff from py&quot;</span>
    <span class="token punctuation">)</span>

<span class="token comment"># create a base object to hold the list of levels</span>
base <span class="token operator">=</span> Base<span class="token punctuation">(</span>data<span class="token operator">=</span>levels<span class="token punctuation">)</span>
<span class="token comment"># and send the data to the server and get back the hash of the object</span>
obj_id <span class="token operator">=</span> operations<span class="token punctuation">.</span>send<span class="token punctuation">(</span>base<span class="token punctuation">,</span> <span class="token punctuation">[</span>transport<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># now create a commit on that branch with your updated data!</span>
commid_id <span class="token operator">=</span> client<span class="token punctuation">.</span>commit<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
    STREAM_ID<span class="token punctuation">,</span>
    obj_id<span class="token punctuation">,</span>
    branch_name<span class="token punctuation">,</span>
    message<span class="token operator">=</span><span class="token string">&quot;add detached materials&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>If we go back to the web to look at the stream, you'll see your newest commit. The geometry should look the same since this hasn't been modified, but stepping into the data will show you the new material attribute. As you can see in the gif below, the id of the <code>Concrete</code> object is the same on different floor slabs since the attribute is detached and the objects are identical.</p> <p><img src="/assets/img/pysample-materials-data.dee7f66f.gif" alt=""></p> <p>Now that you've sent your changes to the server, anyone you're collaborating with will also be able to pull down your changes and use these updated elements with materials data!</p> <h2 id="do-cool-stuff"><a href="#do-cool-stuff" class="header-anchor">#</a> Do Cool Stuff</h2> <p>We've now seen how we can receive, work with, and send data from Python just like you can with any of the other SDKs and connectors. Great, now we can use that data to make something cool! Let's plot the data using <a href="https://plotly.com/python/" target="_blank" rel="noopener noreferrer">plotly<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and display it on a simple page using <a href="https://dash.plotly.com/layout" target="_blank" rel="noopener noreferrer">dash<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. I won't go into too much detail on using the libraries themselves, but most of the plotting code has just been modified from the boilerplate and examples in their docs.</p> <p>To start, let's extract some existing data from the objects and plot them. Each geometry object we're interested in has a <code>Vertices</code> attribute containing a list of points. Let's plot the vertices of the floor slabs and columns on a 3D scatter plot. To do this, we'll need to construct a pandas data frame with the values we are interested in by iterating through the levels.</p> <div class="language-py line-numbers-mode"><pre class="language-py"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token keyword">def</span> <span class="token function">construct_points_df</span><span class="token punctuation">(</span>levels<span class="token punctuation">:</span> List<span class="token punctuation">[</span>Base<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># initialise a pandas data frame</span>
    df_vertices <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;y&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;z&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;element&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    vertices <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> level <span class="token keyword">in</span> levels<span class="token punctuation">:</span>
        <span class="token comment"># add column vertices</span>
        columns <span class="token operator">=</span> level<span class="token punctuation">[</span><span class="token string">&quot;@columns&quot;</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> column <span class="token keyword">in</span> columns<span class="token punctuation">:</span>
            points <span class="token operator">=</span> column<span class="token punctuation">.</span>Vertices
            <span class="token keyword">for</span> p <span class="token keyword">in</span> points<span class="token punctuation">:</span>
                vertices<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">:</span> p<span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token string">&quot;y&quot;</span><span class="token punctuation">:</span> p<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token string">&quot;z&quot;</span><span class="token punctuation">:</span> p<span class="token punctuation">.</span>z<span class="token punctuation">,</span> <span class="token string">&quot;element&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;columns&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token comment"># add floor slab vertices</span>
        floorslab <span class="token operator">=</span> level<span class="token punctuation">[</span><span class="token string">&quot;@floorSlab&quot;</span><span class="token punctuation">]</span>
        points <span class="token operator">=</span> floorslab<span class="token punctuation">.</span>Vertices
        <span class="token keyword">for</span> p <span class="token keyword">in</span> points<span class="token punctuation">:</span>
            vertices<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">:</span> p<span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token string">&quot;y&quot;</span><span class="token punctuation">:</span> p<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token string">&quot;z&quot;</span><span class="token punctuation">:</span> p<span class="token punctuation">.</span>z<span class="token punctuation">,</span> <span class="token string">&quot;element&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;floorSlab&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> df_vertices<span class="token punctuation">.</span>append<span class="token punctuation">(</span>vertices<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>Now we can just pass that data frame into the plotly express <code>scatter_3d</code> method and <code>show()</code> the figure.</p> <div class="language-py line-numbers-mode"><pre class="language-py"><code><span class="token keyword">import</span> plotly<span class="token punctuation">.</span>express <span class="token keyword">as</span> px

df_vertices <span class="token operator">=</span> construct_points_df<span class="token punctuation">(</span>levels<span class="token punctuation">)</span>

fig <span class="token operator">=</span> px<span class="token punctuation">.</span>scatter_3d<span class="token punctuation">(</span>
    df_vertices<span class="token punctuation">,</span>
    x<span class="token operator">=</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">,</span>
    y<span class="token operator">=</span><span class="token string">&quot;y&quot;</span><span class="token punctuation">,</span>
    z<span class="token operator">=</span><span class="token string">&quot;z&quot;</span><span class="token punctuation">,</span>
    color<span class="token operator">=</span><span class="token string">&quot;element&quot;</span><span class="token punctuation">,</span>
    opacity<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span>
    title<span class="token operator">=</span><span class="token string">&quot;Element Vertices (m)&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

fig<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>Plotly plots have interactivity built in, so this is all the code we need to produce this 3D scatter plot.</p> <p><img src="/assets/img/pysample-vertices-plot.e76f8d7b.gif" alt=""></p> <p>Next, let's make use of the material properties we added to each of the stream objects. Let's calculate the mass and embodied carbon for each element type in one level and construct a data frame with the results.</p> <div class="language-py line-numbers-mode"><pre class="language-py"><code><span class="token keyword">def</span> <span class="token function">construct_carbon_df</span><span class="token punctuation">(</span>level<span class="token punctuation">:</span> Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;element&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;volume&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;mass&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;embodied carbon&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span>

    <span class="token comment"># get the attributes on the level object</span>
    names <span class="token operator">=</span> level<span class="token punctuation">.</span>get_dynamic_member_names<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># iterate through and find the elements with a `volume` attribute</span>
    <span class="token keyword">for</span> name <span class="token keyword">in</span> names<span class="token punctuation">:</span>
        prop <span class="token operator">=</span> level<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>prop<span class="token punctuation">,</span> Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>prop<span class="token punctuation">,</span> <span class="token string">&quot;volume&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
            <span class="token comment"># if it has a volume, use the material attribute to calculated</span>
            <span class="token comment"># the embodied carbon</span>
            data<span class="token punctuation">[</span><span class="token string">&quot;volume&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>prop<span class="token punctuation">.</span>volume<span class="token punctuation">)</span>
            data<span class="token punctuation">[</span><span class="token string">&quot;mass&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">&quot;volume&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> prop<span class="token punctuation">[</span><span class="token string">&quot;@material&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>density<span class="token punctuation">)</span>
            data<span class="token punctuation">[</span><span class="token string">&quot;embodied carbon&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>
                data<span class="token punctuation">[</span><span class="token string">&quot;mass&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> prop<span class="token punctuation">[</span><span class="token string">&quot;@material&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>embodied_carbon
            <span class="token punctuation">)</span>
        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>prop<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>prop<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;volume&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
            data<span class="token punctuation">[</span><span class="token string">&quot;volume&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>volume <span class="token keyword">for</span> p <span class="token keyword">in</span> prop<span class="token punctuation">)</span><span class="token punctuation">)</span>
            data<span class="token punctuation">[</span><span class="token string">&quot;mass&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">&quot;volume&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> prop<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;@material&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>density<span class="token punctuation">)</span>
            data<span class="token punctuation">[</span><span class="token string">&quot;embodied carbon&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>
                data<span class="token punctuation">[</span><span class="token string">&quot;mass&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> prop<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;@material&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>embodied_carbon
            <span class="token punctuation">)</span>
        data<span class="token punctuation">[</span><span class="token string">&quot;element&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>name<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># removing the prepending `@`</span>

    <span class="token keyword">return</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>Using this data frame, we can use the plotly express <code>pie()</code> and <code>bar()</code> methods to create some lovely plots.</p> <div class="language-py line-numbers-mode"><pre class="language-py"><code><span class="token comment"># take the first level from our levels list and construct a data frame</span>
df_carbon <span class="token operator">=</span> construct_carbon_df<span class="token punctuation">(</span>levels<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># let's add them all to a dict to keep the together</span>
figures <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

figures<span class="token punctuation">[</span><span class="token string">&quot;volumes&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> px<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>
    df_carbon<span class="token punctuation">,</span>
    values<span class="token operator">=</span><span class="token string">&quot;volume&quot;</span><span class="token punctuation">,</span>
    names<span class="token operator">=</span><span class="token string">&quot;element&quot;</span><span class="token punctuation">,</span>
    color<span class="token operator">=</span><span class="token string">&quot;element&quot;</span><span class="token punctuation">,</span>
    title<span class="token operator">=</span><span class="token string">&quot;Volumes of Elements Per Floor (m3)&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

figures<span class="token punctuation">[</span><span class="token string">&quot;carbon bar&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> px<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>
    df_carbon<span class="token punctuation">,</span>
    x<span class="token operator">=</span><span class="token string">&quot;element&quot;</span><span class="token punctuation">,</span>
    y<span class="token operator">=</span><span class="token string">&quot;embodied carbon&quot;</span><span class="token punctuation">,</span>
    color<span class="token operator">=</span><span class="token string">&quot;element&quot;</span><span class="token punctuation">,</span>
    title<span class="token operator">=</span><span class="token string">&quot;Embodied Carbon Per Floor (kgC02)&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

figures<span class="token punctuation">[</span><span class="token string">&quot;carbon pie&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> px<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>
    df_carbon<span class="token punctuation">,</span>
    values<span class="token operator">=</span><span class="token string">&quot;embodied carbon&quot;</span><span class="token punctuation">,</span>
    names<span class="token operator">=</span><span class="token string">&quot;element&quot;</span><span class="token punctuation">,</span>
    color<span class="token operator">=</span><span class="token string">&quot;element&quot;</span><span class="token punctuation">,</span>
    title<span class="token operator">=</span><span class="token string">&quot;Embodied Carbon Per Floor (kgC02)&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>The last thing we're going to do is add the figures to a dash app. To do this, we are simply taking the boilerplate <a href="https://dash.plotly.com/layout" target="_blank" rel="noopener noreferrer">dash layout<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, replacing the sample figure with our own figures, and adding some custom css in <code>/assets/style.css</code>.</p> <!----> <p>Now all that's left is to run <code>app.py</code> and head to <a href="http://127.0.0.1:8050/" target="_blank" rel="noopener noreferrer"><code>http://127.0.0.1:8050/</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to see your amazing plots.</p> <p><img src="/assets/img/pysample-dashboard.d6c2f3a2.gif" alt=""></p> <h2 id="conclusion"><a href="#conclusion" class="header-anchor">#</a> Conclusion</h2> <p>And voila - you've created the basis for a dashboard powered by your Speckle data! This is just a simple start, and we'd love to see the interesting things you build with Speckle. If you have any questions or want to share what you've been hacking, start a conversation on our <a href="https://speckle.community/" target="_blank" rel="noopener noreferrer">forum<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>For reference, all the code for this project can be found <a href="https://github.com/izzylys/demo-specklepy" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/specklesystems/speckle-docs/edit/main/dev/py-sample.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/1/2021, 7:20:52 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/dev/py-examples.html" class="prev">
        Examples
      </a></span> <span class="next"><a href="/dev/js.html">
        Introduction
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.99a85e76.js" defer></script><script src="/assets/js/4.4326cdb2.js" defer></script><script src="/assets/js/17.0ca52ce1.js" defer></script><script src="/assets/js/27.f73e931d.js" defer></script>
  </body>
</html>
